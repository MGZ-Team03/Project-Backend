---
title: SpeakTracker - íŠœí„° ë§¤ì¹­ ì‹œí€€ìŠ¤
---
sequenceDiagram
    autonumber
    participant S as ðŸ‘¨â€ðŸŽ“ Student
    participant FE_S as ðŸ–¥ï¸ Student App
    participant API as ðŸ”Œ API Gateway
    participant Lambda as âš¡ Lambda
    participant DB as ðŸ—„ï¸ DynamoDB
    participant WS as ðŸ”— WebSocket
    participant FE_T as ðŸ–¥ï¸ Tutor App
    participant T as ðŸ‘¨â€ðŸ« Tutor

    rect rgb(230, 245, 255)
        Note over S,T: 1ï¸âƒ£ í•™ìƒì´ íŠœí„° ê²€ìƒ‰
        S->>FE_S: íŠœí„° ê²€ìƒ‰ ë²„íŠ¼ í´ë¦­
        FE_S->>API: GET /api/tutors?search=ê¹€íŠœí„°
        API->>Lambda: Invoke TutorHandler
        Lambda->>DB: Query Users (role=tutor)
        DB-->>Lambda: Tutor list
        Lambda-->>API: 200 OK
        API-->>FE_S: {tutors: [{email, name, isAccepting}]}
        FE_S-->>S: íŠœí„° ëª©ë¡ í‘œì‹œ
    end

    rect rgb(255, 245, 230)
        Note over S,T: 2ï¸âƒ£ í•™ìƒì´ ë§¤ì¹­ ìš”ì²­ ì „ì†¡
        S->>FE_S: íŠœí„° ì„ íƒ + ë©”ì‹œì§€ ìž‘ì„±
        FE_S->>API: POST /api/tutors/{email}/request
        API->>Lambda: Invoke TutorHandler
        Lambda->>DB: Put TutorRequests<br/>{status: PENDING}
        Lambda->>DB: Put Notifications (íŠœí„°ìš©)
        Lambda->>WS: Send to tutor connection
        WS-->>FE_T: ðŸ”” NEW_TUTOR_REQUEST
        FE_T-->>T: ì•Œë¦¼ í‘œì‹œ
        Lambda-->>API: 200 OK
        API-->>FE_S: {requestId, status: PENDING}
        FE_S-->>S: "ìš”ì²­ì´ ì „ì†¡ë˜ì—ˆìŠµë‹ˆë‹¤"
    end

    rect rgb(230, 255, 230)
        Note over S,T: 3ï¸âƒ£ íŠœí„°ê°€ ìš”ì²­ ìŠ¹ì¸
        T->>FE_T: ìš”ì²­ ëª©ë¡ í™•ì¸
        FE_T->>API: GET /api/tutor/requests?status=PENDING
        API->>Lambda: Invoke TutorHandler
        Lambda->>DB: Query TutorRequests
        DB-->>Lambda: Request list
        Lambda-->>FE_T: {requests: [...]}
        FE_T-->>T: ëŒ€ê¸° ì¤‘ ìš”ì²­ í‘œì‹œ
        
        T->>FE_T: "ìŠ¹ì¸" ë²„íŠ¼ í´ë¦­
        FE_T->>API: POST /api/tutors/requests/{id}/approve
        API->>Lambda: Invoke TutorHandler
        
        Note over Lambda,DB: DynamoDB Transaction
        Lambda->>DB: TransactWriteItems
        Note right of DB: 1. Update TutorRequests (APPROVED)<br/>2. Put TutorStudents<br/>3. Put Notifications (í•™ìƒìš©)
        
        Lambda->>WS: Send to student connection
        WS-->>FE_S: ðŸ”” TUTOR_REQUEST_APPROVED
        FE_S->>FE_S: Redux ìƒíƒœ ì—…ë°ì´íŠ¸
        FE_S-->>S: "íŠœí„°ê°€ ë°°ì •ë˜ì—ˆìŠµë‹ˆë‹¤!" ðŸŽ‰
        
        Lambda-->>API: 200 OK
        API-->>FE_T: {message: "ìŠ¹ì¸ ì™„ë£Œ"}
        FE_T-->>T: í•™ìƒ ëª©ë¡ì— ì¶”ê°€ë¨
    end

    rect rgb(255, 230, 230)
        Note over S,T: 3ï¸âƒ£-alt íŠœí„°ê°€ ìš”ì²­ ê±°ì ˆ
        T->>FE_T: "ê±°ì ˆ" ë²„íŠ¼ í´ë¦­ + ì‚¬ìœ  ìž…ë ¥
        FE_T->>API: POST /api/tutors/requests/{id}/reject
        API->>Lambda: Invoke TutorHandler
        Lambda->>DB: Update TutorRequests (REJECTED)
        Lambda->>DB: Put Notifications (ê±°ì ˆ ì‚¬ìœ  í¬í•¨)
        Lambda->>WS: Send to student connection
        WS-->>FE_S: ðŸ”” TUTOR_REQUEST_REJECTED
        FE_S-->>S: "ìš”ì²­ì´ ê±°ì ˆë˜ì—ˆìŠµë‹ˆë‹¤" + ì‚¬ìœ 
        Lambda-->>FE_T: {message: "ê±°ì ˆ ì™„ë£Œ"}
    end

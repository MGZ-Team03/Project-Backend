---
title: SpeakTracker System Architecture (AWS Serverless)
---
flowchart TB
    subgraph Client["ğŸ–¥ï¸ Client Layer"]
        Browser["React SPA<br/>(Browser)"]
        Mobile["Mobile App"]
    end

    subgraph CDN["ğŸŒ CDN Layer"]
        CloudFront["Amazon CloudFront<br/>- HTTPS<br/>- ìºì‹±<br/>- SPA ë¼ìš°íŒ…"]
    end

    subgraph Storage_Static["ğŸ“¦ Static Storage"]
        S3_Frontend["Amazon S3<br/>(Frontend)<br/>- React Build<br/>- ì •ì  ì—ì…‹"]
    end

    subgraph API_Layer["ğŸ”Œ API Layer"]
        APIGW_REST["API Gateway<br/>(REST API)<br/>- Cognito Authorizer<br/>- Throttling"]
        APIGW_WS["API Gateway<br/>(WebSocket)<br/>- $connect<br/>- $disconnect<br/>- $default"]
    end

    subgraph Compute["âš¡ Compute Layer (Lambda)"]
        Lambda_Auth["Auth Handler<br/>- íšŒì›ê°€ì…<br/>- ë¡œê·¸ì¸<br/>- í”„ë¡œí•„"]
        Lambda_Tutor["Tutor Handler<br/>- í•™ìƒ ëª©ë¡<br/>- í”¼ë“œë°± ì „ì†¡"]
        Lambda_Student["Student Handler<br/>- íŠœí„° ë§¤ì¹­<br/>- í•™ìŠµ ì„¸ì…˜"]
        Lambda_AI["AI Handler<br/>- ë¬¸ì¥ ìƒì„±<br/>- AI ëŒ€í™”"]
        Lambda_TTS["TTS Handler<br/>- Polly í˜¸ì¶œ<br/>- ì˜¤ë””ì˜¤ ì €ì¥"]
        Lambda_WS["WebSocket Handler<br/>- ì—°ê²° ê´€ë¦¬<br/>- ë©”ì‹œì§€ ë¸Œë¡œë“œìºìŠ¤íŠ¸"]
    end

    subgraph Queue["ğŸ“¬ Message Queue"]
        SQS_TTS["Amazon SQS<br/>(TTS Queue)"]
        SQS_AI["Amazon SQS<br/>(AI Chat Queue)"]
        DLQ["Dead Letter Queue<br/>(ì‹¤íŒ¨ ë©”ì‹œì§€)"]
    end

    subgraph Database["ğŸ—„ï¸ Database Layer"]
        DynamoDB["Amazon DynamoDB<br/>- Users<br/>- TutorStudents<br/>- LearningSessions<br/>- ê¸°íƒ€ 9ê°œ í…Œì´ë¸”"]
    end

    subgraph Storage_User["ğŸ“ User Content Storage"]
        S3_User["Amazon S3<br/>(User Content)<br/>- í”„ë¡œí•„ ì´ë¯¸ì§€<br/>- ì˜¤ë””ì˜¤ íŒŒì¼<br/>- TTS ê²°ê³¼"]
    end

    subgraph External["ğŸŒ External Services"]
        Cognito["Amazon Cognito<br/>- User Pool<br/>- JWT Token"]
        Polly["Amazon Polly<br/>- TTS (ì˜ì–´/í•œêµ­ì–´)"]
        Transcribe["Amazon Transcribe<br/>- STT (ë°±ì—…)"]
        SES["Amazon SES<br/>- ì´ë©”ì¼ ë°œì†¡"]
        Claude["Claude AI API<br/>- ëŒ€í™” ìƒì„±<br/>- ë¬¸ì¥ ìƒì„±"]
    end

    subgraph Monitoring["ğŸ“Š Monitoring"]
        CloudWatch["CloudWatch<br/>- Logs<br/>- Metrics<br/>- Alarms"]
        XRay["X-Ray<br/>- Tracing"]
    end

    %% Client Connections
    Browser --> CloudFront
    Mobile --> CloudFront
    Browser -->|"REST API"| APIGW_REST
    Browser -->|"WebSocket"| APIGW_WS
    Mobile -->|"REST API"| APIGW_REST

    %% CDN to Storage
    CloudFront --> S3_Frontend

    %% API Gateway to Lambda
    APIGW_REST -->|"Invoke"| Lambda_Auth
    APIGW_REST -->|"Invoke"| Lambda_Tutor
    APIGW_REST -->|"Invoke"| Lambda_Student
    APIGW_REST -->|"Invoke"| Lambda_AI
    APIGW_REST -->|"Invoke"| Lambda_TTS
    APIGW_WS -->|"Invoke"| Lambda_WS

    %% Lambda to Database
    Lambda_Auth --> DynamoDB
    Lambda_Tutor --> DynamoDB
    Lambda_Student --> DynamoDB
    Lambda_AI --> DynamoDB
    Lambda_TTS --> DynamoDB
    Lambda_WS --> DynamoDB

    %% Lambda to External Services
    Lambda_Auth --> Cognito
    Lambda_Auth --> SES
    Lambda_TTS --> Polly
    Lambda_TTS --> S3_User
    Lambda_AI --> Claude

    %% SQS Flow
    Lambda_TTS -->|"Send"| SQS_TTS
    Lambda_AI -->|"Send"| SQS_AI
    SQS_TTS -->|"Trigger"| Lambda_TTS
    SQS_AI -->|"Trigger"| Lambda_AI
    SQS_TTS -->|"3íšŒ ì‹¤íŒ¨"| DLQ
    SQS_AI -->|"3íšŒ ì‹¤íŒ¨"| DLQ

    %% WebSocket Broadcast
    Lambda_WS -->|"Push"| APIGW_WS

    %% Monitoring
    Lambda_Auth -.-> CloudWatch
    Lambda_Tutor -.-> CloudWatch
    Lambda_Student -.-> CloudWatch
    Lambda_AI -.-> CloudWatch
    Lambda_TTS -.-> CloudWatch
    DLQ -.->|"Alarm"| CloudWatch

    %% Styling
    classDef client fill:#e1f5fe,stroke:#01579b
    classDef aws fill:#ff9800,stroke:#e65100,color:#fff
    classDef lambda fill:#ff9800,stroke:#e65100
    classDef database fill:#4caf50,stroke:#2e7d32,color:#fff
    classDef external fill:#9c27b0,stroke:#6a1b9a,color:#fff
    classDef queue fill:#2196f3,stroke:#1565c0,color:#fff

    class Browser,Mobile client
    class CloudFront,APIGW_REST,APIGW_WS,S3_Frontend,S3_User aws
    class Lambda_Auth,Lambda_Tutor,Lambda_Student,Lambda_AI,Lambda_TTS,Lambda_WS lambda
    class DynamoDB database
    class Cognito,Polly,Transcribe,SES,Claude external
    class SQS_TTS,SQS_AI,DLQ queue
